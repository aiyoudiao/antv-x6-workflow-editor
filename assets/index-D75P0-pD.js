import{r as O,e as Je,ah as _,aa as Ke,b1 as me,c4 as L,c5 as xe,k as f,J as j}from"./index-CgvDPn_Q.js";import{V as Z,c as qe,C as Qe,o as Ee,a as A,b as ie,w as Ze,h as et,R as Se,d as tt,e as ne,r as se,f as $,g as I,i as it,j as Te,k as X,p as nt,G as S,B as ee,l as De,M as ve,m as Pe,t as oe,A as Y,P as q,n as we,q as re,s as st,N as ze,u as ot,v as ue,K as rt,S as at,O as ae,x as le,y as ye,z as lt}from"./index-COepjBPJ.js";import{d as ct}from"./throttle-BJiVXReG.js";import{F as V}from"./index-BYX4FxE4.js";import{L as Ce}from"./index-DpQOLSxW.js";import{I as ce}from"./index-CxxUdSiS.js";import{S as k}from"./index-Dnp_laQi.js";import{D as Oe}from"./index-BbVFE8Zo.js";import{S as dt}from"./index-Dcsix1oD.js";import"./row-ua_M7p23.js";import"./responsiveObserver-BAX92A_c.js";import"./index-DVxbxsKq.js";import"./LeftOutlined-BDY2_scL.js";import"./useBreakpoint-COs5d6bW.js";import"./SearchOutlined-nudLcr53.js";import"./Overflow-K8lHzaP5.js";import"./index-vpBmKpwy.js";import"./DownOutlined-2chhhJCP.js";const ht={BASE_URL:"/antv-x6-workflow-editor",DEV:!1,MODE:"prod",PROD:!0,SSR:!1,VITE_APP_DESC:"SoybeanAdmin is a fresh and elegant admin template",VITE_APP_TITLE:"SoybeanAdmin",VITE_AUTH_ROUTE_MODE:"static",VITE_AUTOMATICALLY_DETECT_UPDATE:"Y",VITE_BASE_URL:"/antv-x6-workflow-editor",VITE_CONSTANT_ROUTE_MODE:"static",VITE_HTTP_PROXY:"Y",VITE_ICON_LOCAL_PREFIX:"icon-local",VITE_ICON_PREFIX:"icon",VITE_MENU_ICON:"mdi:menu",VITE_OTHER_SERVICE_BASE_URL:`{
  "demo": "http://localhost:9529"
}`,VITE_ROUTER_HISTORY_MODE:"history",VITE_ROUTE_HOME:"home",VITE_SERVICE_BASE_URL:"https://mock.apifox.cn/m1/3109515-0-default",VITE_SERVICE_EXPIRED_TOKEN_CODES:"9999,9998,3333",VITE_SERVICE_LOGOUT_CODES:"8888,8889",VITE_SERVICE_MODAL_LOGOUT_CODES:"7777,7778",VITE_SERVICE_SUCCESS_CODE:"0000",VITE_SOURCE_MAP:"N",VITE_STATIC_SUPER_ROLE:"R_SUPER",VITE_STORAGE_PREFIX:"SOY-REACT_"},Re=n=>{let e;const t=new Set,i=(b,m)=>{const p=typeof b=="function"?b(e):b;if(!Object.is(p,e)){const g=e;e=m??(typeof p!="object"||p===null)?p:Object.assign({},e,p),t.forEach(x=>x(e,g))}},o=()=>e,c={setState:i,getState:o,getInitialState:()=>d,subscribe:b=>(t.add(b),()=>t.delete(b)),destroy:()=>{(ht?"prod":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},d=e=n(i,o,c);return c},ut=n=>n?Re(n):Re;var Ae={exports:{}},je={},Ve={exports:{}},Be={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W=O;function pt(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var ft=typeof Object.is=="function"?Object.is:pt,gt=W.useState,bt=W.useEffect,mt=W.useLayoutEffect,xt=W.useDebugValue;function Et(n,e){var t=e(),i=gt({inst:{value:t,getSnapshot:e}}),o=i[0].inst,s=i[1];return mt(function(){o.value=t,o.getSnapshot=e,de(o)&&s({inst:o})},[n,t,e]),bt(function(){return de(o)&&s({inst:o}),n(function(){de(o)&&s({inst:o})})},[n]),xt(t),t}function de(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!ft(n,t)}catch{return!0}}function St(n,e){return e()}var vt=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?St:Et;Be.useSyncExternalStore=W.useSyncExternalStore!==void 0?W.useSyncExternalStore:vt;Ve.exports=Be;var wt=Ve.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var te=O,yt=wt;function Ct(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Ot=typeof Object.is=="function"?Object.is:Ct,Rt=yt.useSyncExternalStore,Nt=te.useRef,Mt=te.useEffect,_t=te.useMemo,It=te.useDebugValue;je.useSyncExternalStoreWithSelector=function(n,e,t,i,o){var s=Nt(null);if(s.current===null){var r={hasValue:!1,value:null};s.current=r}else r=s.current;s=_t(function(){function c(g){if(!d){if(d=!0,b=g,g=i(g),o!==void 0&&r.hasValue){var x=r.value;if(o(x,g))return m=x}return m=g}if(x=m,Ot(b,g))return x;var h=i(g);return o!==void 0&&o(x,h)?x:(b=g,m=h)}var d=!1,b,m,p=t===void 0?null:t;return[function(){return c(e())},p===null?void 0:function(){return c(p())}]},[e,t,i,o]);var a=Rt(n,s[0],s[1]);return Mt(function(){r.hasValue=!0,r.value=a},[a]),It(a),a};Ae.exports=je;var Tt=Ae.exports;const Dt=Je(Tt),Le={BASE_URL:"/antv-x6-workflow-editor",DEV:!1,MODE:"prod",PROD:!0,SSR:!1,VITE_APP_DESC:"SoybeanAdmin is a fresh and elegant admin template",VITE_APP_TITLE:"SoybeanAdmin",VITE_AUTH_ROUTE_MODE:"static",VITE_AUTOMATICALLY_DETECT_UPDATE:"Y",VITE_BASE_URL:"/antv-x6-workflow-editor",VITE_CONSTANT_ROUTE_MODE:"static",VITE_HTTP_PROXY:"Y",VITE_ICON_LOCAL_PREFIX:"icon-local",VITE_ICON_PREFIX:"icon",VITE_MENU_ICON:"mdi:menu",VITE_OTHER_SERVICE_BASE_URL:`{
  "demo": "http://localhost:9529"
}`,VITE_ROUTER_HISTORY_MODE:"history",VITE_ROUTE_HOME:"home",VITE_SERVICE_BASE_URL:"https://mock.apifox.cn/m1/3109515-0-default",VITE_SERVICE_EXPIRED_TOKEN_CODES:"9999,9998,3333",VITE_SERVICE_LOGOUT_CODES:"8888,8889",VITE_SERVICE_MODAL_LOGOUT_CODES:"7777,7778",VITE_SERVICE_SUCCESS_CODE:"0000",VITE_SOURCE_MAP:"N",VITE_STATIC_SUPER_ROLE:"R_SUPER",VITE_STORAGE_PREFIX:"SOY-REACT_"},{useDebugValue:Pt}=_,{useSyncExternalStoreWithSelector:zt}=Dt;let Ne=!1;const At=n=>n;function ke(n,e=At,t){(Le?"prod":void 0)!=="production"&&t&&!Ne&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Ne=!0);const i=zt(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return Pt(i),i}const Me=n=>{(Le?"prod":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?ut(n):n,t=(i,o)=>ke(e,i,o);return Object.assign(t,e),t},jt=n=>n?Me(n):Me;var Vt=function(n,e,t,i){var o=arguments.length,s=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(e,t,s):r(e,t))||s);return o>3&&s&&Object.defineProperty(e,t,s),s};class Ue extends Z{get graph(){return this.options.graph}get boxClassName(){return this.prefixClassName(P.classNames.box)}get $boxes(){return qe(this.container,this.boxClassName)}get handleOptions(){return this.options}constructor(e){super(),this.options=e,this.options.model&&(this.options.collection=this.options.model.collection),this.options.collection?this.collection=this.options.collection:(this.collection=new Qe([],{comparator:P.depthComparator}),this.options.collection=this.collection),this.boxCount=0,this.createContainer(),this.startListening()}startListening(){const e=this.graph,t=this.collection;this.delegateEvents({[`mousedown .${this.boxClassName}`]:"onSelectionBoxMouseDown",[`touchstart .${this.boxClassName}`]:"onSelectionBoxMouseDown"},!0),e.on("scale",this.onGraphTransformed,this),e.on("translate",this.onGraphTransformed,this),e.model.on("updated",this.onModelUpdated,this),t.on("added",this.onCellAdded,this),t.on("removed",this.onCellRemoved,this),t.on("reseted",this.onReseted,this),t.on("updated",this.onCollectionUpdated,this),t.on("node:change:position",this.onNodePositionChanged,this),t.on("cell:changed",this.onCellChanged,this)}stopListening(){const e=this.graph,t=this.collection;this.undelegateEvents(),e.off("scale",this.onGraphTransformed,this),e.off("translate",this.onGraphTransformed,this),e.model.off("updated",this.onModelUpdated,this),t.off("added",this.onCellAdded,this),t.off("removed",this.onCellRemoved,this),t.off("reseted",this.onReseted,this),t.off("updated",this.onCollectionUpdated,this),t.off("node:change:position",this.onNodePositionChanged,this),t.off("cell:changed",this.onCellChanged,this)}onRemove(){this.stopListening()}onGraphTransformed(){this.updateSelectionBoxes()}onCellChanged(){this.updateSelectionBoxes()}onNodePositionChanged({node:e,options:t}){const{showNodeSelectionBox:i,pointerEvents:o}=this.options,{ui:s,selection:r,translateBy:a,snapped:c}=t,d=(i!==!0||o&&this.getPointerEventsValue(o)==="none")&&!this.translating&&!r,b=s&&a&&e.id===a;if(d&&(b||c)){this.translating=!0;const m=e.position(),p=e.previous("position"),g=m.x-p.x,x=m.y-p.y;(g!==0||x!==0)&&this.translateSelectedNodes(g,x,e,t),this.translating=!1}}onModelUpdated({removed:e}){e&&e.length&&this.unselect(e)}isEmpty(){return this.length<=0}isSelected(e){return this.collection.has(e)}get length(){return this.collection.length}get cells(){return this.collection.toArray()}select(e,t={}){t.dryrun=!0;const i=this.filter(Array.isArray(e)?e:[e]);return this.collection.add(i,t),this}unselect(e,t={}){return t.dryrun=!0,this.collection.remove(Array.isArray(e)?e:[e],t),this}reset(e,t={}){if(e){if(t.batch){const d=this.filter(Array.isArray(e)?e:[e]);return this.collection.reset(d,Object.assign(Object.assign({},t),{ui:!0})),this}const i=this.cells,o=this.filter(Array.isArray(e)?e:[e]),s={},r={};i.forEach(d=>s[d.id]=d),o.forEach(d=>r[d.id]=d);const a=[],c=[];return o.forEach(d=>{s[d.id]||a.push(d)}),i.forEach(d=>{r[d.id]||c.push(d)}),c.length&&this.unselect(c,Object.assign(Object.assign({},t),{ui:!0})),a.length&&this.select(a,Object.assign(Object.assign({},t),{ui:!0})),c.length===0&&a.length===0&&this.updateContainer(),this}return this.clean(t)}clean(e={}){return this.length&&(e.batch===!1?this.unselect(this.cells,e):this.collection.reset([],Object.assign(Object.assign({},e),{ui:!0}))),this}setFilter(e){this.options.filter=e}setContent(e){this.options.content=e}startSelecting(e){e=this.normalizeEvent(e),this.clean();let t,i;const o=this.graph.container;if(e.offsetX!=null&&e.offsetY!=null&&o.contains(e.target))t=e.offsetX,i=e.offsetY;else{const s=Ee(o),r=o.scrollLeft,a=o.scrollTop;t=e.clientX-s.left+window.pageXOffset+r,i=e.clientY-s.top+window.pageYOffset+a}A(this.container,{top:i,left:t,width:1,height:1}),this.setEventData(e,{action:"selecting",clientX:e.clientX,clientY:e.clientY,offsetX:t,offsetY:i,scrollerX:0,scrollerY:0,moving:!1}),this.delegateDocumentEvents(P.documentEvents,e.data)}filter(e){const t=this.options.filter;return e.filter(i=>Array.isArray(t)?t.some(o=>typeof o=="string"?i.shape===o:i.id===o.id):typeof t=="function"?ie(t,this.graph,i):!0)}stopSelecting(e){const t=this.graph,i=this.getEventData(e);switch(i.action){case"selecting":{let s=Ze(this.container),r=et(this.container);const a=Ee(this.container),c=t.pageToLocal(a.left,a.top),d=t.transform.getScale();s/=d.sx,r/=d.sy;const b=new Se(c.x,c.y,s,r),m=this.getCellViewsInArea(b).map(p=>p.cell);this.reset(m,{batch:!0}),this.hideRubberband();break}case"translating":{const s=t.snapToGrid(e.clientX,e.clientY);if(!this.options.following){const r=i;this.updateSelectedNodesPosition({dx:r.clientX-r.originX,dy:r.clientY-r.originY})}this.graph.model.stopBatch("move-selection"),this.notifyBoxEvent("box:mouseup",e,s.x,s.y);break}default:{this.clean();break}}}onMouseUp(e){this.getEventData(e).action&&(this.stopSelecting(e),this.undelegateDocumentEvents())}onSelectionBoxMouseDown(e){this.options.following||e.stopPropagation();const t=this.normalizeEvent(e);this.options.movable&&this.startTranslating(t);const i=this.getCellViewFromElem(t.target);this.setEventData(t,{activeView:i});const o=this.graph.snapToGrid(t.clientX,t.clientY);this.notifyBoxEvent("box:mousedown",t,o.x,o.y),this.delegateDocumentEvents(P.documentEvents,t.data)}startTranslating(e){this.graph.model.startBatch("move-selection");const t=this.graph.snapToGrid(e.clientX,e.clientY);this.setEventData(e,{action:"translating",clientX:t.x,clientY:t.y,originX:t.x,originY:t.y})}getRestrictArea(){const e=this.graph.options.translating.restrict,t=typeof e=="function"?ie(e,this.graph,null):e;return typeof t=="number"?this.graph.transform.getGraphArea().inflate(t):t===!0?this.graph.transform.getGraphArea():t||null}getSelectionOffset(e,t){let i=e.x-t.clientX,o=e.y-t.clientY;const s=this.getRestrictArea();if(s){const r=this.collection.toArray(),a=tt.getCellsBBox(r,{deep:!0})||Se.create(),c=s.x-a.x,d=s.y-a.y,b=s.x+s.width-(a.x+a.width),m=s.y+s.height-(a.y+a.height);if(i<c&&(i=c),o<d&&(o=d),b<i&&(i=b),m<o&&(o=m),!this.options.following){const p=e.x-t.originX,g=e.y-t.originY;i=p<=c||p>=b?0:i,o=g<=d||g>=m?0:o}}return{dx:i,dy:o}}updateElementPosition(e,t,i){const o=A(e,"left"),s=A(e,"top"),r=o?parseFloat(o):0,a=s?parseFloat(s):0;A(e,"left",r+t),A(e,"top",a+i)}updateSelectedNodesPosition(e){const{dx:t,dy:i}=e;if(t||i)if(this.translateSelectedNodes(t,i),this.boxesUpdated)this.collection.length>1&&this.updateSelectionBoxes();else{const o=this.graph.transform.getScale();for(let s=0,r=this.$boxes,a=r.length;s<a;s+=1)this.updateElementPosition(r[s],t*o.sx,i*o.sy);this.updateElementPosition(this.selectionContainer,t*o.sx,i*o.sy)}}autoScrollGraph(e,t){const i=this.graph.getPlugin("scroller");return i?i.autoScroll(e,t):{scrollerX:0,scrollerY:0}}adjustSelection(e){const t=this.normalizeEvent(e),i=this.getEventData(t);switch(i.action){case"selecting":{const s=i;s.moving!==!0&&(ne(this.container,this.graph.container),this.showRubberband(),s.moving=!0);const{scrollerX:r,scrollerY:a}=this.autoScrollGraph(t.clientX,t.clientY);s.scrollerX+=r,s.scrollerY+=a;const c=t.clientX-s.clientX+s.scrollerX,d=t.clientY-s.clientY+s.scrollerY,b=parseInt(A(this.container,"left")||"0",10),m=parseInt(A(this.container,"top")||"0",10);A(this.container,{left:c<0?s.offsetX+c:b,top:d<0?s.offsetY+d:m,width:Math.abs(c),height:Math.abs(d)});break}case"translating":{const s=this.graph.snapToGrid(t.clientX,t.clientY),r=i,a=this.getSelectionOffset(s,r);this.options.following?this.updateSelectedNodesPosition(a):this.updateContainerPosition(a),a.dx&&(r.clientX=s.x),a.dy&&(r.clientY=s.y),this.notifyBoxEvent("box:mousemove",e,s.x,s.y);break}}this.boxesUpdated=!1}translateSelectedNodes(e,t,i,o){const s={},r=[];if(i&&(s[i.id]=!0),this.collection.toArray().forEach(a=>{a.getDescendants({deep:!0}).forEach(c=>{s[c.id]=!0})}),o&&o.translateBy){const a=this.graph.getCellById(o.translateBy);a&&(s[a.id]=!0,a.getDescendants({deep:!0}).forEach(c=>{s[c.id]=!0}),r.push(a))}this.collection.toArray().forEach(a=>{if(!s[a.id]){const c=Object.assign(Object.assign({},o),{selection:this.cid,exclude:r});a.translate(e,t,c),this.graph.model.getConnectedEdges(a).forEach(d=>{s[d.id]||(d.translate(e,t,c),s[d.id]=!0)})}})}getCellViewsInArea(e){const t=this.graph,i={strict:this.options.strict};let o=[];return this.options.rubberNode&&(o=o.concat(t.model.getNodesInArea(e,i).map(s=>t.renderer.findViewByCell(s)).filter(s=>s!=null))),this.options.rubberEdge&&(o=o.concat(t.model.getEdgesInArea(e,i).map(s=>t.renderer.findViewByCell(s)).filter(s=>s!=null))),o}notifyBoxEvent(e,t,i,o){const r=this.getEventData(t).activeView;this.trigger(e,{e:t,view:r,x:i,y:o,cell:r.cell})}getSelectedClassName(e){return this.prefixClassName(`${e.isNode()?"node":"edge"}-selected`)}addCellSelectedClassName(e){const t=this.graph.renderer.findViewByCell(e);t&&t.addClass(this.getSelectedClassName(e))}removeCellUnSelectedClassName(e){const t=this.graph.renderer.findViewByCell(e);t&&t.removeClass(this.getSelectedClassName(e))}destroySelectionBox(e){this.removeCellUnSelectedClassName(e),this.canShowSelectionBox(e)&&(se(this.container.querySelector(`[data-cell-id="${e.id}"]`)),this.$boxes.length===0&&this.hide(),this.boxCount=Math.max(0,this.boxCount-1))}destroyAllSelectionBoxes(e){e.forEach(t=>this.removeCellUnSelectedClassName(t)),this.hide(),se(this.$boxes),this.boxCount=0}hide(){$(this.container,this.prefixClassName(P.classNames.rubberband)),$(this.container,this.prefixClassName(P.classNames.selected))}showRubberband(){I(this.container,this.prefixClassName(P.classNames.rubberband))}hideRubberband(){$(this.container,this.prefixClassName(P.classNames.rubberband))}showSelected(){it(this.container,"style"),I(this.container,this.prefixClassName(P.classNames.selected))}createContainer(){this.container=document.createElement("div"),I(this.container,this.prefixClassName(P.classNames.root)),this.options.className&&I(this.container,this.options.className),this.selectionContainer=document.createElement("div"),I(this.selectionContainer,this.prefixClassName(P.classNames.inner)),this.selectionContent=document.createElement("div"),I(this.selectionContent,this.prefixClassName(P.classNames.content)),Te(this.selectionContainer,this.selectionContent),X(this.selectionContainer,"data-selection-length",this.collection.length),nt(this.container,this.selectionContainer)}updateContainerPosition(e){(e.dx||e.dy)&&this.updateElementPosition(this.selectionContainer,e.dx,e.dy)}updateContainer(){const e={x:1/0,y:1/0},t={x:0,y:0};this.collection.toArray().filter(s=>this.canShowSelectionBox(s)).forEach(s=>{const r=this.graph.renderer.findViewByCell(s);if(r){const a=r.getBBox({useCellGeometry:!0});e.x=Math.min(e.x,a.x),e.y=Math.min(e.y,a.y),t.x=Math.max(t.x,a.x+a.width),t.y=Math.max(t.y,a.y+a.height)}}),A(this.selectionContainer,{position:"absolute",pointerEvents:"none",left:e.x,top:e.y,width:t.x-e.x,height:t.y-e.y}),X(this.selectionContainer,"data-selection-length",this.collection.length);const o=this.options.content;if(o)if(typeof o=="function"){const s=ie(o,this.graph,this,this.selectionContent);s&&(this.selectionContent.innerHTML=s)}else this.selectionContent.innerHTML=o;this.collection.length>0&&!this.container.parentNode?ne(this.container,this.graph.container):this.collection.length<=0&&this.container.parentNode&&this.container.parentNode.removeChild(this.container)}canShowSelectionBox(e){return e.isNode()&&this.options.showNodeSelectionBox===!0||e.isEdge()&&this.options.showEdgeSelectionBox===!0}getPointerEventsValue(e){return typeof e=="string"?e:e(this.cells)}createSelectionBox(e){if(this.addCellSelectedClassName(e),this.canShowSelectionBox(e)){const t=this.graph.renderer.findViewByCell(e);if(t){const i=t.getBBox({useCellGeometry:!0}),o=this.boxClassName,s=document.createElement("div"),r=this.options.pointerEvents;I(s,o),I(s,`${o}-${e.isNode()?"node":"edge"}`),X(s,"data-cell-id",e.id),A(s,{position:"absolute",left:i.x,top:i.y,width:i.width,height:i.height,pointerEvents:r?this.getPointerEventsValue(r):"auto"}),ne(s,this.container),this.showSelected(),this.boxCount+=1}}}updateSelectionBoxes(){this.collection.length>0&&(this.boxesUpdated=!0,this.confirmUpdate())}confirmUpdate(){if(this.boxCount){this.hide();for(let e=0,t=this.$boxes,i=t.length;e<i;e+=1){const o=t[e],s=X(o,"data-cell-id");se(o),this.boxCount-=1;const r=this.collection.get(s);r&&this.createSelectionBox(r)}this.updateContainer()}return 0}getCellViewFromElem(e){const t=e.getAttribute("data-cell-id");if(t){const i=this.collection.get(t);if(i)return this.graph.renderer.findViewByCell(i)}return null}onCellRemoved({cell:e}){this.destroySelectionBox(e),this.updateContainer()}onReseted({previous:e,current:t}){this.destroyAllSelectionBoxes(e),t.forEach(i=>{this.listenCellRemoveEvent(i),this.createSelectionBox(i)}),this.updateContainer()}onCellAdded({cell:e}){this.listenCellRemoveEvent(e),this.createSelectionBox(e),this.updateContainer()}listenCellRemoveEvent(e){e.off("removed",this.onCellRemoved,this),e.on("removed",this.onCellRemoved,this)}onCollectionUpdated({added:e,removed:t,options:i}){e.forEach(s=>{this.trigger("cell:selected",{cell:s,options:i}),s.isNode()?this.trigger("node:selected",{cell:s,options:i,node:s}):s.isEdge()&&this.trigger("edge:selected",{cell:s,options:i,edge:s})}),t.forEach(s=>{this.trigger("cell:unselected",{cell:s,options:i}),s.isNode()?this.trigger("node:unselected",{cell:s,options:i,node:s}):s.isEdge()&&this.trigger("edge:unselected",{cell:s,options:i,edge:s})});const o={added:e,removed:t,options:i,selected:this.cells.filter(s=>!!this.graph.getCellById(s.id))};this.trigger("selection:changed",o)}dispose(){this.clean(),this.remove(),this.off()}}Vt([Z.dispose()],Ue.prototype,"dispose",null);var P;(function(n){const e="widget-selection";n.classNames={root:e,inner:`${e}-inner`,box:`${e}-box`,content:`${e}-content`,rubberband:`${e}-rubberband`,selected:`${e}-selected`},n.documentEvents={mousemove:"adjustSelection",touchmove:"adjustSelection",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"};function t(i){return i.getAncestors().length}n.depthComparator=t})(P||(P={}));const Bt=`.x6-widget-selection {
  position: absolute;
  top: 0;
  left: 0;
  display: none;
  width: 0;
  height: 0;
  touch-action: none;
}
.x6-widget-selection-rubberband {
  display: block;
  overflow: visible;
  opacity: 0.3;
}
.x6-widget-selection-selected {
  display: block;
}
.x6-widget-selection-box {
  cursor: move;
}
.x6-widget-selection-inner[data-selection-length='0'],
.x6-widget-selection-inner[data-selection-length='1'] {
  display: none;
}
.x6-widget-selection-content {
  position: absolute;
  top: 100%;
  right: -20px;
  left: -20px;
  margin-top: 30px;
  padding: 6px;
  line-height: 14px;
  text-align: center;
  border-radius: 6px;
}
.x6-widget-selection-content:empty {
  display: none;
}
.x6-widget-selection-rubberband {
  background-color: #3498db;
  border: 2px solid #2980b9;
}
.x6-widget-selection-box {
  box-sizing: content-box !important;
  margin-top: -4px;
  margin-left: -4px;
  padding-right: 4px;
  padding-bottom: 4px;
  border: 2px dashed #feb663;
  box-shadow: 2px 2px 5px #d3d3d3;
}
.x6-widget-selection-inner {
  box-sizing: content-box !important;
  margin-top: -8px;
  margin-left: -8px;
  padding-right: 12px;
  padding-bottom: 12px;
  border: 2px solid #feb663;
  box-shadow: 2px 2px 5px #d3d3d3;
}
.x6-widget-selection-content {
  color: #fff;
  font-size: 10px;
  background-color: #6a6b8a;
}
`;S.prototype.isSelectionEnabled=function(){const n=this.getPlugin("selection");return n?n.isEnabled():!1};S.prototype.enableSelection=function(){const n=this.getPlugin("selection");return n&&n.enable(),this};S.prototype.disableSelection=function(){const n=this.getPlugin("selection");return n&&n.disable(),this};S.prototype.toggleSelection=function(n){const e=this.getPlugin("selection");return e&&e.toggleEnabled(n),this};S.prototype.isMultipleSelection=function(){const n=this.getPlugin("selection");return n?n.isMultipleSelection():!1};S.prototype.enableMultipleSelection=function(){const n=this.getPlugin("selection");return n&&n.enableMultipleSelection(),this};S.prototype.disableMultipleSelection=function(){const n=this.getPlugin("selection");return n&&n.disableMultipleSelection(),this};S.prototype.toggleMultipleSelection=function(n){const e=this.getPlugin("selection");return e&&e.toggleMultipleSelection(n),this};S.prototype.isSelectionMovable=function(){const n=this.getPlugin("selection");return n?n.isSelectionMovable():!1};S.prototype.enableSelectionMovable=function(){const n=this.getPlugin("selection");return n&&n.enableSelectionMovable(),this};S.prototype.disableSelectionMovable=function(){const n=this.getPlugin("selection");return n&&n.disableSelectionMovable(),this};S.prototype.toggleSelectionMovable=function(n){const e=this.getPlugin("selection");return e&&e.toggleSelectionMovable(n),this};S.prototype.isRubberbandEnabled=function(){const n=this.getPlugin("selection");return n?n.isRubberbandEnabled():!1};S.prototype.enableRubberband=function(){const n=this.getPlugin("selection");return n&&n.enableRubberband(),this};S.prototype.disableRubberband=function(){const n=this.getPlugin("selection");return n&&n.disableRubberband(),this};S.prototype.toggleRubberband=function(n){const e=this.getPlugin("selection");return e&&e.toggleRubberband(n),this};S.prototype.isStrictRubberband=function(){const n=this.getPlugin("selection");return n?n.isStrictRubberband():!1};S.prototype.enableStrictRubberband=function(){const n=this.getPlugin("selection");return n&&n.enableStrictRubberband(),this};S.prototype.disableStrictRubberband=function(){const n=this.getPlugin("selection");return n&&n.disableStrictRubberband(),this};S.prototype.toggleStrictRubberband=function(n){const e=this.getPlugin("selection");return e&&e.toggleStrictRubberband(n),this};S.prototype.setRubberbandModifiers=function(n){const e=this.getPlugin("selection");return e&&e.setRubberbandModifiers(n),this};S.prototype.setSelectionFilter=function(n){const e=this.getPlugin("selection");return e&&e.setSelectionFilter(n),this};S.prototype.setSelectionDisplayContent=function(n){const e=this.getPlugin("selection");return e&&e.setSelectionDisplayContent(n),this};S.prototype.isSelectionEmpty=function(){const n=this.getPlugin("selection");return n?n.isEmpty():!0};S.prototype.cleanSelection=function(n){const e=this.getPlugin("selection");return e&&e.clean(n),this};S.prototype.resetSelection=function(n,e){const t=this.getPlugin("selection");return t&&t.reset(n,e),this};S.prototype.getSelectedCells=function(){const n=this.getPlugin("selection");return n?n.getSelectedCells():[]};S.prototype.getSelectedCellCount=function(){const n=this.getPlugin("selection");return n?n.getSelectedCellCount():0};S.prototype.isSelected=function(n){const e=this.getPlugin("selection");return e?e.isSelected(n):!1};S.prototype.select=function(n,e){const t=this.getPlugin("selection");return t&&t.select(n,e),this};S.prototype.unselect=function(n,e){const t=this.getPlugin("selection");return t&&t.unselect(n,e),this};var Lt=function(n,e,t,i){var o=arguments.length,s=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(e,t,s):r(e,t))||s);return o>3&&s&&Object.defineProperty(e,t,s),s};class F extends ee{get rubberbandDisabled(){return this.options.enabled!==!0||this.options.rubberband!==!0}get disabled(){return this.options.enabled!==!0}get length(){return this.selectionImpl.length}get cells(){return this.selectionImpl.cells}constructor(e={}){super(),this.name="selection",this.movedMap=new WeakMap,this.unselectMap=new WeakMap,this.options=Object.assign(Object.assign({enabled:!0},F.defaultOptions),e),De(this.name,Bt)}init(e){this.graph=e,this.selectionImpl=new Ue(Object.assign(Object.assign({},this.options),{graph:e})),this.setup(),this.startListening()}isEnabled(){return!this.disabled}enable(){this.disabled&&(this.options.enabled=!0)}disable(){this.disabled||(this.options.enabled=!1)}toggleEnabled(e){return e!=null?e!==this.isEnabled()&&(e?this.enable():this.disable()):this.isEnabled()?this.disable():this.enable(),this}isMultipleSelection(){return this.isMultiple()}enableMultipleSelection(){return this.enableMultiple(),this}disableMultipleSelection(){return this.disableMultiple(),this}toggleMultipleSelection(e){return e!=null?e!==this.isMultipleSelection()&&(e?this.enableMultipleSelection():this.disableMultipleSelection()):this.isMultipleSelection()?this.disableMultipleSelection():this.enableMultipleSelection(),this}isSelectionMovable(){return this.options.movable!==!1}enableSelectionMovable(){return this.selectionImpl.options.movable=!0,this}disableSelectionMovable(){return this.selectionImpl.options.movable=!1,this}toggleSelectionMovable(e){return e!=null?e!==this.isSelectionMovable()&&(e?this.enableSelectionMovable():this.disableSelectionMovable()):this.isSelectionMovable()?this.disableSelectionMovable():this.enableSelectionMovable(),this}isRubberbandEnabled(){return!this.rubberbandDisabled}enableRubberband(){return this.rubberbandDisabled&&(this.options.rubberband=!0),this}disableRubberband(){return this.rubberbandDisabled||(this.options.rubberband=!1),this}toggleRubberband(e){return e!=null?e!==this.isRubberbandEnabled()&&(e?this.enableRubberband():this.disableRubberband()):this.isRubberbandEnabled()?this.disableRubberband():this.enableRubberband(),this}isStrictRubberband(){return this.selectionImpl.options.strict===!0}enableStrictRubberband(){return this.selectionImpl.options.strict=!0,this}disableStrictRubberband(){return this.selectionImpl.options.strict=!1,this}toggleStrictRubberband(e){return e!=null?e!==this.isStrictRubberband()&&(e?this.enableStrictRubberband():this.disableStrictRubberband()):this.isStrictRubberband()?this.disableStrictRubberband():this.enableStrictRubberband(),this}setRubberbandModifiers(e){this.setModifiers(e)}setSelectionFilter(e){return this.setFilter(e),this}setSelectionDisplayContent(e){return this.setContent(e),this}isEmpty(){return this.length<=0}clean(e={}){return this.selectionImpl.clean(e),this}reset(e,t={}){return this.selectionImpl.reset(e?this.getCells(e):[],t),this}getSelectedCells(){return this.cells}getSelectedCellCount(){return this.length}isSelected(e){return this.selectionImpl.isSelected(e)}select(e,t={}){const i=this.getCells(e);return i.length&&(this.isMultiple()?this.selectionImpl.select(i,t):this.reset(i.slice(0,1),t)),this}unselect(e,t={}){return this.selectionImpl.unselect(this.getCells(e),t),this}setup(){this.selectionImpl.on("*",(e,t)=>{this.trigger(e,t),this.graph.trigger(e,t)})}startListening(){this.graph.on("blank:mousedown",this.onBlankMouseDown,this),this.graph.on("blank:click",this.onBlankClick,this),this.graph.on("cell:mousemove",this.onCellMouseMove,this),this.graph.on("cell:mouseup",this.onCellMouseUp,this),this.selectionImpl.on("box:mousedown",this.onBoxMouseDown,this)}stopListening(){this.graph.off("blank:mousedown",this.onBlankMouseDown,this),this.graph.off("blank:click",this.onBlankClick,this),this.graph.off("cell:mousemove",this.onCellMouseMove,this),this.graph.off("cell:mouseup",this.onCellMouseUp,this),this.selectionImpl.off("box:mousedown",this.onBoxMouseDown,this)}onBlankMouseDown({e}){if(!this.allowBlankMouseDown(e))return;const t=this.graph.panning.allowPanning(e,!0),i=this.graph.getPlugin("scroller"),o=i&&i.allowPanning(e,!0);(this.allowRubberband(e,!0)||this.allowRubberband(e)&&!o&&!t)&&this.startRubberband(e)}allowBlankMouseDown(e){const t=this.options.eventTypes;return(t==null?void 0:t.includes("leftMouseDown"))&&e.button===0||(t==null?void 0:t.includes("mouseWheelDown"))&&e.button===1}onBlankClick(){this.clean()}allowRubberband(e,t){return!this.rubberbandDisabled&&ve.isMatch(e,this.options.modifiers,t)}allowMultipleSelection(e){return this.isMultiple()&&ve.isMatch(e,this.options.multipleSelectionModifiers)}onCellMouseMove({cell:e}){this.movedMap.set(e,!0)}onCellMouseUp({e,cell:t}){const i=this.options;let o=this.disabled;!o&&this.movedMap.has(t)&&(o=i.selectCellOnMoved===!1,o||(o=i.selectNodeOnMoved===!1&&t.isNode()),o||(o=i.selectEdgeOnMoved===!1&&t.isEdge())),o||(this.allowMultipleSelection(e)?this.unselectMap.has(t)?this.unselectMap.delete(t):this.isSelected(t)?this.unselect(t):this.select(t):this.reset(t)),this.movedMap.delete(t)}onBoxMouseDown({e,cell:t}){this.disabled||this.allowMultipleSelection(e)&&(this.unselect(t),this.unselectMap.set(t,!0))}getCells(e){return(Array.isArray(e)?e:[e]).map(t=>typeof t=="string"?this.graph.getCellById(t):t).filter(t=>t!=null)}startRubberband(e){return this.rubberbandDisabled||this.selectionImpl.startSelecting(e),this}isMultiple(){return this.options.multiple!==!1}enableMultiple(){return this.options.multiple=!0,this}disableMultiple(){return this.options.multiple=!1,this}setModifiers(e){return this.options.modifiers=e,this}setContent(e){return this.selectionImpl.setContent(e),this}setFilter(e){return this.selectionImpl.setFilter(e),this}dispose(){this.stopListening(),this.off(),this.selectionImpl.dispose(),Pe(this.name)}}Lt([ee.dispose()],F.prototype,"dispose",null);(function(n){n.defaultOptions={rubberband:!1,rubberNode:!0,rubberEdge:!1,pointerEvents:"auto",multiple:!0,multipleSelectionModifiers:["ctrl","meta"],movable:!0,strict:!1,selectCellOnMoved:!1,selectNodeOnMoved:!1,selectEdgeOnMoved:!1,following:!0,content:null,eventTypes:["leftMouseDown","mouseWheelDown"]}})(F||(F={}));var kt=function(n,e,t,i){var o=arguments.length,s=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(e,t,s):r(e,t))||s);return o>3&&s&&Object.defineProperty(e,t,s),s};class Ge extends Z{get model(){return this.graph.model}get view(){return this.graph.renderer.findViewByCell(this.node)}get containerClassName(){return this.prefixClassName("widget-transform")}get resizeClassName(){return`${this.containerClassName}-resize`}get rotateClassName(){return`${this.containerClassName}-rotate`}constructor(e,t,i){super(),this.node=t,this.graph=i,this.options=Object.assign(Object.assign({},M.defaultOptions),e),this.render(),this.startListening()}startListening(){this.delegateEvents({[`mousedown .${this.resizeClassName}`]:"startResizing",[`touchstart .${this.resizeClassName}`]:"startResizing",[`mousedown .${this.rotateClassName}`]:"startRotating",[`touchstart .${this.rotateClassName}`]:"startRotating"}),this.model.on("*",this.update,this),this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this),this.node.on("removed",this.remove,this),this.model.on("reseted",this.remove,this),this.view.on("cell:knob:mousedown",this.onKnobMouseDown,this),this.view.on("cell:knob:mouseup",this.onKnobMouseUp,this)}stopListening(){this.undelegateEvents(),this.model.off("*",this.update,this),this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this),this.node.off("removed",this.remove,this),this.model.off("reseted",this.remove,this),this.view.off("cell:knob:mousedown",this.onKnobMouseDown,this),this.view.off("cell:knob:mouseup",this.onKnobMouseUp,this)}renderHandles(){this.container=document.createElement("div");const e=document.createElement("div");X(e,"draggable","false");const t=e.cloneNode(!0);I(t,this.rotateClassName);const i=M.POSITIONS.map(o=>{const s=e.cloneNode(!0);return I(s,this.resizeClassName),X(s,"data-position",o),s});this.empty(),Te(this.container,[...i,t])}render(){return this.renderHandles(),this.view&&this.view.addClass(M.NODE_CLS),I(this.container,this.containerClassName),oe(this.container,"no-orth-resize",this.options.preserveAspectRatio||!this.options.orthogonalResizing),oe(this.container,"no-resize",!this.options.resizable),oe(this.container,"no-rotate",!this.options.rotatable),this.options.className&&I(this.container,this.options.className),this.graph.container.appendChild(this.container),this.update()}update(){const e=this.graph.matrix(),t=this.node.getBBox();t.x*=e.a,t.x+=e.e,t.y*=e.d,t.y+=e.f,t.width*=e.a,t.height*=e.d;const i=Y.normalize(this.node.getAngle()),o=i!==0?`rotate(${i}deg)`:"";return A(this.container,{transform:o,width:t.width,height:t.height,left:t.x,top:t.y}),this.updateResizerDirections(),this}remove(){return this.view&&this.view.removeClass(M.NODE_CLS),super.remove()}onKnobMouseDown(){this.startHandle()}onKnobMouseUp(){this.stopHandle()}updateResizerDirections(){const e=Y.normalize(this.node.getAngle()),t=Math.floor(e*(M.DIRECTIONS.length/360));if(t!==this.prevShift){const i=M.DIRECTIONS.slice(t).concat(M.DIRECTIONS.slice(0,t)),o=r=>`${this.containerClassName}-cursor-${r}`;this.container.querySelectorAll(`.${this.resizeClassName}`).forEach((r,a)=>{$(r,M.DIRECTIONS.map(c=>o(c)).join(" ")),I(r,o(i[a]))}),this.prevShift=t}}getTrueDirection(e){const t=Y.normalize(this.node.getAngle());let i=M.POSITIONS.indexOf(e);return i+=Math.floor(t*(M.POSITIONS.length/360)),i%=M.POSITIONS.length,M.POSITIONS[i]}toValidResizeDirection(e){return{top:"top-left",bottom:"bottom-right",left:"bottom-left",right:"top-right"}[e]||e}startResizing(e){e.stopPropagation(),this.model.startBatch("resize",{cid:this.cid});const t=X(e.target,"data-position");this.prepareResizing(e,t),this.startAction(e)}prepareResizing(e,t){const i=this.getTrueDirection(t);let o=0,s=0;t.split("-").forEach(d=>{o={left:-1,right:1}[d]||o,s={top:-1,bottom:1}[d]||s});const r=this.toValidResizeDirection(t),a={"top-right":"bottomLeft","top-left":"bottomRight","bottom-left":"topRight","bottom-right":"topLeft"}[r],c=Y.normalize(this.node.getAngle());this.setEventData(e,{selector:a,direction:r,trueDirection:i,relativeDirection:t,angle:c,resizeX:o,resizeY:s,action:"resizing"})}startRotating(e){e.stopPropagation(),this.model.startBatch("rotate",{cid:this.cid});const t=this.node.getBBox().getCenter(),i=this.normalizeEvent(e),o=this.graph.snapToGrid(i.clientX,i.clientY);this.setEventData(e,{center:t,action:"rotating",angle:Y.normalize(this.node.getAngle()),start:q.create(o).theta(t)}),this.startAction(e)}onMouseMove(e){const t=this.graph.findViewByCell(this.node);let i=this.getEventData(e);if(i.action){const o=this.normalizeEvent(e);let s=o.clientX,r=o.clientY;const a=this.graph.getPlugin("scroller"),c=this.options.restrictedResizing;if(c===!0||typeof c=="number"){const g=c===!0?0:c,x=a?Math.max(g,8):g,h=this.graph.container.getBoundingClientRect();s=we(s,h.left+x,h.right-x),r=we(r,h.top+x,h.bottom-x)}else this.options.autoScrollOnResizing&&a&&a.autoScroll(s,r);const d=this.graph.snapToGrid(s,r),b=this.graph.getGridSize(),m=this.node,p=this.options;if(i.action==="resizing"){i=i,i.resized||(t&&(t.addClass("node-resizing"),this.notify("node:resize",e,t)),i.resized=!0);const g=m.getBBox(),x=q.create(d).rotate(i.angle,g.getCenter()).diff(g[i.selector]);let h=i.resizeX?x.x*i.resizeX:g.width,u=i.resizeY?x.y*i.resizeY:g.height;const y=h,R=u;if(h=re.snapToGrid(h,b),u=re.snapToGrid(u,b),h=Math.max(h,p.minWidth||b),u=Math.max(u,p.minHeight||b),h=Math.min(h,p.maxWidth||1/0),u=Math.min(u,p.maxHeight||1/0),p.preserveAspectRatio){const l=g.width*u/g.height,w=g.height*h/g.width;h<l?u=w:h=l}const N=i.relativeDirection;if(p.allowReverse&&(y<=-h||R<=-u)){let l;N==="left"?y<=-h&&(l="right"):N==="right"?y<=-h&&(l="left"):N==="top"?R<=-u&&(l="bottom"):N==="bottom"?R<=-u&&(l="top"):N==="top-left"?y<=-h&&R<=-u?l="bottom-right":y<=-h?l="top-right":R<=-u&&(l="bottom-left"):N==="top-right"?y<=-h&&R<=-u?l="bottom-left":y<=-h?l="top-left":R<=-u&&(l="bottom-right"):N==="bottom-left"?y<=-h&&R<=-u?l="top-right":y<=-h?l="bottom-right":R<=-u&&(l="top-left"):N==="bottom-right"&&(y<=-h&&R<=-u?l="top-left":y<=-h?l="bottom-left":R<=-u&&(l="top-right"));const w=l;this.stopHandle();const v=this.container.querySelector(`.${this.resizeClassName}[data-position="${w}"]`);this.startHandle(v),this.prepareResizing(e,w),this.onMouseMove(e)}if(g.width!==h||g.height!==u){const l={ui:!0,direction:i.direction,relativeDirection:i.relativeDirection,trueDirection:i.trueDirection,minWidth:p.minWidth,minHeight:p.minHeight,maxWidth:p.maxWidth,maxHeight:p.maxHeight,preserveAspectRatio:p.preserveAspectRatio===!0};m.resize(h,u,l),this.notify("node:resizing",e,t)}}else if(i.action==="rotating"){i=i,i.rotated||(t&&(t.addClass("node-rotating"),this.notify("node:rotate",e,t)),i.rotated=!0);const g=m.getAngle(),x=i.start-q.create(d).theta(i.center);let h=i.angle+x;p.rotateGrid&&(h=re.snapToGrid(h,p.rotateGrid)),h=Y.normalize(h),g!==h&&(m.rotate(h,{absolute:!0}),this.notify("node:rotating",e,t))}}}onMouseUp(e){const t=this.getEventData(e);t.action&&(this.stopAction(e),this.model.stopBatch(t.action==="resizing"?"resize":"rotate",{cid:this.cid}))}startHandle(e){if(this.handle=e||null,I(this.container,`${this.containerClassName}-active`),e){I(e,`${this.containerClassName}-active-handle`);const t=e.getAttribute("data-position");if(t){const i=M.DIRECTIONS[M.POSITIONS.indexOf(t)];I(this.container,`${this.containerClassName}-cursor-${i}`)}}}stopHandle(){if($(this.container,`${this.containerClassName}-active`),this.handle){$(this.handle,`${this.containerClassName}-active-handle`);const e=this.handle.getAttribute("data-position");if(e){const t=M.DIRECTIONS[M.POSITIONS.indexOf(e)];$(this.container,`${this.containerClassName}-cursor-${t}`)}this.handle=null}}startAction(e){this.startHandle(e.target),this.graph.view.undelegateEvents(),this.delegateDocumentEvents(M.documentEvents,e.data)}stopAction(e){this.stopHandle(),this.undelegateDocumentEvents(),this.graph.view.delegateEvents();const t=this.graph.findViewByCell(this.node),i=this.getEventData(e);t&&(t.removeClass(`node-${i.action}`),i.action==="resizing"&&i.resized?this.notify("node:resized",e,t):i.action==="rotating"&&i.rotated&&this.notify("node:rotated",e,t))}notify(e,t,i,o={}){if(i){const s=i.graph,r=s.view.normalizeEvent(t),a=s.snapToGrid(r.clientX,r.clientY);this.trigger(e,Object.assign({e:r,view:i,node:i.cell,cell:i.cell,x:a.x,y:a.y},o))}}dispose(){this.stopListening(),this.remove(),this.off()}}kt([Z.dispose()],Ge.prototype,"dispose",null);var M;(function(n){n.NODE_CLS="has-widget-transform",n.DIRECTIONS=["nw","n","ne","e","se","s","sw","w"],n.POSITIONS=["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"],n.documentEvents={mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp"},n.defaultOptions={minWidth:0,minHeight:0,maxWidth:1/0,maxHeight:1/0,rotateGrid:15,rotatable:!0,preserveAspectRatio:!1,orthogonalResizing:!0,restrictedResizing:!1,autoScrollOnResizing:!0,allowReverse:!0}})(M||(M={}));const Ut=`.x6-widget-transform {
  position: absolute;
  box-sizing: content-box !important;
  margin: -5px 0 0 -5px;
  padding: 4px;
  border: 1px dashed #000;
  border-radius: 5px;
  user-select: none;
  pointer-events: none;
}
.x6-widget-transform > div {
  position: absolute;
  box-sizing: border-box;
  background-color: #fff;
  border: 1px solid #000;
  transition: background-color 0.2s;
  pointer-events: auto;
  -webkit-user-drag: none;
  user-drag: none;
  /* stylelint-disable-line */
}
.x6-widget-transform > div:hover {
  background-color: #d3d3d3;
}
.x6-widget-transform-cursor-n {
  cursor: n-resize;
}
.x6-widget-transform-cursor-s {
  cursor: s-resize;
}
.x6-widget-transform-cursor-e {
  cursor: e-resize;
}
.x6-widget-transform-cursor-w {
  cursor: w-resize;
}
.x6-widget-transform-cursor-ne {
  cursor: ne-resize;
}
.x6-widget-transform-cursor-nw {
  cursor: nw-resize;
}
.x6-widget-transform-cursor-se {
  cursor: se-resize;
}
.x6-widget-transform-cursor-sw {
  cursor: sw-resize;
}
.x6-widget-transform-resize {
  width: 10px;
  height: 10px;
  border-radius: 6px;
}
.x6-widget-transform-resize[data-position='top-left'] {
  top: -5px;
  left: -5px;
}
.x6-widget-transform-resize[data-position='top-right'] {
  top: -5px;
  right: -5px;
}
.x6-widget-transform-resize[data-position='bottom-left'] {
  bottom: -5px;
  left: -5px;
}
.x6-widget-transform-resize[data-position='bottom-right'] {
  right: -5px;
  bottom: -5px;
}
.x6-widget-transform-resize[data-position='top'] {
  top: -5px;
  left: 50%;
  margin-left: -5px;
}
.x6-widget-transform-resize[data-position='bottom'] {
  bottom: -5px;
  left: 50%;
  margin-left: -5px;
}
.x6-widget-transform-resize[data-position='left'] {
  top: 50%;
  left: -5px;
  margin-top: -5px;
}
.x6-widget-transform-resize[data-position='right'] {
  top: 50%;
  right: -5px;
  margin-top: -5px;
}
.x6-widget-transform.prevent-aspect-ratio .x6-widget-transform-resize[data-position='top'],
.x6-widget-transform.prevent-aspect-ratio .x6-widget-transform-resize[data-position='bottom'],
.x6-widget-transform.prevent-aspect-ratio .x6-widget-transform-resize[data-position='left'],
.x6-widget-transform.prevent-aspect-ratio .x6-widget-transform-resize[data-position='right'] {
  display: none;
}
.x6-widget-transform.no-orth-resize .x6-widget-transform-resize[data-position='bottom'],
.x6-widget-transform.no-orth-resize .x6-widget-transform-resize[data-position='left'],
.x6-widget-transform.no-orth-resize .x6-widget-transform-resize[data-position='right'],
.x6-widget-transform.no-orth-resize .x6-widget-transform-resize[data-position='top'] {
  display: none;
}
.x6-widget-transform.no-resize .x6-widget-transform-resize {
  display: none;
}
.x6-widget-transform-rotate {
  top: -20px;
  left: -20px;
  width: 12px;
  height: 12px;
  border-radius: 6px;
  cursor: crosshair;
}
.x6-widget-transform.no-rotate .x6-widget-transform-rotate {
  display: none;
}
.x6-widget-transform-active {
  border-color: transparent;
  pointer-events: all;
}
.x6-widget-transform-active > div {
  display: none;
}
.x6-widget-transform-active > .x6-widget-transform-active-handle {
  display: block;
  background-color: #808080;
}
`;S.prototype.createTransformWidget=function(n){const e=this.getPlugin("transform");return e&&e.createWidget(n),this};S.prototype.clearTransformWidgets=function(){const n=this.getPlugin("transform");return n&&n.clearWidgets(),this};var Gt=function(n,e,t,i){var o=arguments.length,s=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(e,t,s):r(e,t))||s);return o>3&&s&&Object.defineProperty(e,t,s),s};class J extends ee{constructor(e={}){super(),this.name="transform",this.widgets=new Map,this.disabled=!1,this.options=e,De(this.name,Ut)}init(e){this.graph=e,!this.disabled&&this.startListening()}startListening(){this.graph.on("node:click",this.onNodeClick,this),this.graph.on("blank:mousedown",this.onBlankMouseDown,this)}stopListening(){this.graph.off("node:click",this.onNodeClick,this),this.graph.off("blank:mousedown",this.onBlankMouseDown,this)}enable(){this.disabled&&(this.disabled=!1,this.startListening())}disable(){this.disabled||(this.disabled=!0,this.stopListening())}isEnabled(){return!this.disabled}createWidget(e){this.clearWidgets();const t=this.createTransform(e);t&&(this.widgets.set(e,t),t.on("*",(i,o)=>{this.trigger(i,o),this.graph.trigger(i,o)}))}onNodeClick({node:e}){this.createWidget(e)}onBlankMouseDown(){this.clearWidgets()}createTransform(e){const t=this.getTransformOptions(e);return t.resizable||t.rotatable?new Ge(t,e,this.graph):null}getTransformOptions(e){this.options.resizing||(this.options.resizing={enabled:!1}),this.options.rotating||(this.options.rotating={enabled:!1}),typeof this.options.resizing=="boolean"&&(this.options.resizing={enabled:this.options.resizing}),typeof this.options.rotating=="boolean"&&(this.options.rotating={enabled:this.options.rotating});const t=J.parseOptionGroup(this.graph,e,this.options.resizing),i=J.parseOptionGroup(this.graph,e,this.options.rotating);return{resizable:!!t.enabled,minWidth:t.minWidth||0,maxWidth:t.maxWidth||Number.MAX_SAFE_INTEGER,minHeight:t.minHeight||0,maxHeight:t.maxHeight||Number.MAX_SAFE_INTEGER,orthogonalResizing:typeof t.orthogonal=="boolean"?t.orthogonal:!0,restrictedResizing:!!t.restrict,autoScrollOnResizing:typeof t.autoScroll=="boolean"?t.autoScroll:!0,preserveAspectRatio:!!t.preserveAspectRatio,allowReverse:typeof t.allowReverse=="boolean"?t.allowReverse:!0,rotatable:!!i.enabled,rotateGrid:i.grid||15}}clearWidgets(){this.widgets.forEach((e,t)=>{this.graph.getCellById(t.id)&&e.dispose()}),this.widgets.clear()}dispose(){this.clearWidgets(),this.stopListening(),this.off(),Pe(this.name)}}Gt([ee.dispose()],J.prototype,"dispose",null);(function(n){function e(t,i,o){const s={};return Object.keys(o||{}).forEach(r=>{const a=o[r];s[r]=typeof a=="function"?a.call(t,i):a}),s}n.parseOptionGroup=e})(J||(J={}));class _e extends ze{}(function(n){function e(t){const i=[],o=ot.getForeignObjectMarkup();return t?i.push({tagName:t,selector:"body"},o):i.push(o),i}n.config({view:"react-shape-view",markup:e(),attrs:{body:{fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"},fo:{refWidth:"100%",refHeight:"100%"}},propHooks(t){if(t.markup==null){const i=t.primer;if(i){t.markup=e(i);let o={};switch(i){case"circle":o={refCx:"50%",refCy:"50%",refR:"50%"};break;case"ellipse":o={refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%"};break}t.attrs=st({},{body:Object.assign({refWidth:null,refHeight:null},o)},t.attrs||{})}}return t}}),ze.registry.register("react-shape",n,!0)})(_e||(_e={}));var H;(function(n){let e=!1,t;const i=(c,d)=>{const b=d.payload;switch(d.type){case"add":{const m=c.findIndex(p=>p.id===b.id);return m>=0?(c[m]=b,[...c]):[...c,b]}case"remove":{const m=c.findIndex(p=>p.id===b.id);if(m>=0){const p=[...c];return p.splice(m,1),p}break}}return c};function o(c,d){e&&t({type:"add",payload:{id:c,portal:d}})}n.connect=o;function s(c){e&&t({type:"remove",payload:{id:c}})}n.disconnect=s;function r(){return e}n.isActive=r;function a(){return()=>{e=!0;const[c,d]=O.useReducer(i,[]);return t=d,_.createElement(_.Fragment,{children:c.map(b=>b.portal)})}}n.getProvider=a})(H||(H={}));const Ie={};class $t extends _.PureComponent{constructor(e){super(e),this.state={tick:0}}componentDidMount(){const{node:e}=this.props;e.on("change:*",({key:t})=>{const i=Ie[e.shape];if(i){const{effect:o}=i;(!o||o.includes(t))&&this.setState({tick:this.state.tick+1})}})}clone(e){const{node:t,graph:i}=this.props;return typeof e.type=="string"?_.cloneElement(e):_.cloneElement(e,{node:t,graph:i})}render(){const{node:e}=this.props,t=Ie[e.shape];if(!t)return null;const{component:i}=t;if(_.isValidElement(i))return this.clone(i);const o=i;return this.clone(_.createElement(o,null))}}class Q extends ue{getComponentContainer(){return this.selectors&&this.selectors.foContent}confirmUpdate(e){const t=super.confirmUpdate(e);return this.handleAction(t,Q.action,()=>{this.renderReactComponent()})}renderReactComponent(){this.unmountReactComponent();const e=this.getComponentContainer(),t=this.cell;if(e){const i=t.model?t.model.graph:null,o=_.createElement($t,{node:t,graph:i});if(H.isActive()){const s=Ke.createPortal(o,e);H.connect(this.cell.id,s)}else me.render(o,e)}}unmountReactComponent(){const e=this.getComponentContainer();e&&me.unmountComponentAtNode(e)}onMouseDown(e,t,i){const o=e.target;if(o.tagName.toLowerCase()==="input"){const r=o.getAttribute("type");if(r==null||["text","password","number","email","search","tel","url"].includes(r))return}super.onMouseDown(e,t,i)}unmount(){return H.isActive()&&H.disconnect(this.cell.id),this.unmountReactComponent(),super.unmount(),this}}(function(n){n.action="react",n.config({bootstrap:[n.action],actions:{component:n.action}}),ue.registry.register("react-shape-view",n,!0)})(Q||(Q={}));var Xt=Object.defineProperty,Yt=(n,e,t)=>e in n?Xt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ht=(n,e,t)=>(Yt(n,e+"",t),t),pe=O.createContext({graph:null,setGraph:()=>{}}),Wt=({children:n})=>{const[e,t]=O.useState(null);return _.createElement(pe.Provider,{value:{graph:e,setGraph:t}},n)},fe=()=>{const{graph:n}=O.useContext(pe);return n},Ft=({children:n})=>fe()?_.createElement(_.Fragment,null,n):null;function he(n,e){if(typeof e!="object"||Array.isArray(e)||!e)return JSON.parse(JSON.stringify(e));if(typeof e=="object"&&e.toJSON!==void 0&&typeof e.toJSON=="function")return e.toJSON();let t=n;return typeof n!="object"&&(t={...e}),Object.keys(e).forEach(i=>{t.hasOwnProperty(i)||(t[i]=e[i]),e[i]===null||e[i]===void 0?delete t[i]:t[i]!==null&&t[i]!==void 0&&(t[i]=he(t[i],e[i]))}),t}function $e(n,e="/",t){const i={};Object.keys(n).forEach(o=>{const s=n[o];let r=lt(s);if(r&&t&&t(s)&&(r=!1),r){const a=$e(s,e,t);Object.keys(a).forEach(c=>{i[o+e+c]=a[c]})}else i[o]=s});for(const o in n)Object.prototype.hasOwnProperty.call(n,o);return i}var Jt=()=>jt(n=>({nodes:[],edges:[],changeList:[],initData:(e,t)=>n(L(i=>{i.nodes=e.nodes,i.edges=e.edges,t!=null&&t.silent||i.changeList.push({command:"init",data:e})})),addNodes:(e,t)=>n(L(i=>{if(!e.length)return;e.forEach(s=>{s.id||(s.id=ye())});const o=i.nodes.find(s=>e.some(r=>r.id&&r.id===s.id));o?console.error(`node id=${o.id} already existed`):(i.nodes.push(...e),t!=null&&t.silent||i.changeList.push({command:"addNodes",data:e}))})),removeNodes:(e,t)=>n(L(i=>{e.length&&(i.nodes=i.nodes.filter(o=>!e.includes(o.id)),t!=null&&t.silent||i.changeList.push({command:"removeNodes",data:e}))})),updateNode:(e,t,i)=>n(L(o=>{const s=o.nodes.find(r=>r.id===e);if(s){const r=typeof t=="function"?t(xe(s)||{}):t;if(r.id!==void 0||r.shape!==void 0){console.error("id and shape can't be changed");return}he(s,r),i!=null&&i.silent||o.changeList.push({command:"updateNode",data:{id:e,data:r}})}})),addEdges:(e,t)=>n(L(i=>{if(!e.length)return;e.forEach(s=>{s.id||(s.id=ye())});const o=i.edges.find(s=>e.some(r=>r.id&&r.id===s.id));o?console.error(`edge id=${o.id} already existed`):(i.edges.push(...e),t!=null&&t.silent||i.changeList.push({command:"addEdges",data:e}))})),removeEdges:(e,t)=>n(L(i=>{e.length&&(i.edges=i.edges.filter(o=>!e.includes(o.id)),t!=null&&t.silent||i.changeList.push({command:"removeEdges",data:e}))})),updateEdge:(e,t,i)=>n(L(o=>{const s=o.edges.find(r=>r.id===e);if(s){const r=typeof t=="function"?t(xe(s)||{}):t;if(r.id!==void 0||r.shape!==void 0){console.error("id and shape can't be changed");return}he(s,r),i!=null&&i.silent||o.changeList.push({command:"updateEdge",data:{id:e,data:r}})}})),clearChangeList:()=>n(L(e=>{e.changeList=[]}))})),Xe=O.createContext(null),Kt=({children:n})=>{const e=O.useRef();return e.current||(e.current=Jt()),_.createElement(Xe.Provider,{value:e.current},n)},qt=({children:n})=>_.createElement(Kt,null,_.createElement(Wt,null,n)),U=n=>{const e=O.useContext(Xe);if(!e)throw new Error("can only be get inside the xflow component.");return ke(e,n)};function Qt(n){const e=O.useRef(n);return e.current=n,e}var K=(n,e)=>{const t=Qt(e),i=fe();O.useEffect(()=>(i&&(t.current=e,i.on(n,o=>{t.current(o)})),()=>{i&&t.current&&i.off(n,t.current)}),[i])},D="__inner__",Zt=(n,e,t)=>{if(n==="position"){const{x:i,y:o}=q.create(e).snapToGrid(t.getGridSize());return{x:i,y:o}}return n==="size"?{width:e.width,height:e.height}:{[n]:e}},ei=n=>{const{centerView:e,centerViewOptions:t,fitView:i,fitViewOptions:o}=n,s=fe(),r=U(l=>l.updateNode),a=U(l=>l.updateEdge),c=U(l=>l.addNodes),d=U(l=>l.addEdges),b=U(l=>l.removeNodes),m=U(l=>l.removeEdges),p=U(l=>l.changeList),g=U(l=>l.clearChangeList),x=l=>{if(s){const w=l.filter(E=>E.selected),v=l.filter(E=>!E.selected);s.select(w.map(E=>E.id),{[D]:!0}),s.unselect(v.map(E=>E.id),{[D]:!0})}},h=l=>{s&&l.forEach(w=>{const v=s.getCellById(w.id);v&&(w.animated?(v.attr("line/strokeDasharray",5,{[D]:!0}),v.attr("line/style/animation","animated-line 30s infinite linear",{[D]:!0})):(v.attr("line/strokeDasharray",0,{[D]:!0}),v.attr("line/style/animation","",{[D]:!0})))})},u=(l,w)=>{l.fromJSON(le(w)),e&&l.centerContent(t),i&&l.zoomToFit({maxScale:1,...o});const{nodes:v,edges:E}=w;x([...v,...E]),h([...E])},y=(l,w)=>{if(s){const v=Object.keys(w);if(v.includes("selected")){const E=!!w.selected;x([{id:l,selected:E}])}else if(v.includes("animated")){const E=!!w.animated;h([{id:l,animated:E}])}}},R=(l,w,v)=>{if(s){const E=s.getCellById(l);if(E){s.startBatch(v);const T=E.preprocess(w,!0),G=$e(T);Object.keys(G).forEach(B=>{E.setPropByPath(B,G[B],{[D]:!0,rewrite:!0})}),y(l,w),s.stopBatch(v)}}},N=(l,w)=>{w.forEach(v=>{const{command:E,data:T}=v;switch(E){case"init":u(l,T);break;case"addNodes":const G=le(T);l.addNodes(G,{[D]:!0}),x(G);break;case"removeNodes":l.removeCells(T,{[D]:!0});break;case"updateNode":R(T.id,T.data,"updateNode");break;case"addEdges":const B=le(T);l.addEdges(B,{[D]:!0}),x(B),h(B);break;case"removeEdges":l.removeCells(T,{[D]:!0});break;case"updateEdge":R(T.id,T.data,"updateEdge");break}}),setTimeout(()=>{g()})};return O.useEffect(()=>{s&&p.length&&N(s,p)},[p,s]),K("cell:added",({cell:l,options:w})=>{if(!w[D]){if(l.isNode()){const v=[l.toJSON()];c(v,{silent:!0}),x(v)}else if(l.isEdge()){const v=[l.toJSON()];d(v,{silent:!0}),x(v),h(v)}}}),K("cell:removed",({cell:l})=>{l.isNode()?b([l.id],{silent:!0}):l.isEdge()&&m([l.id],{silent:!0})}),K("cell:change:*",ct(({cell:l,key:w,current:v,options:E})=>{!E[D]&&s&&(l.isNode()?r(l.id,Zt(w,v,s),{silent:!0}):l.isEdge()&&a(l.id,{[w]:v},{silent:!0}))},100,{leading:!0})),K("selection:changed",({added:l,removed:w,options:v})=>{v[D]||(l.forEach(E=>{E.isNode()?r(E.id,{selected:!0},{silent:!0}):E.isEdge()&&a(E.id,{selected:!0},{silent:!0})}),w.forEach(E=>{E.isNode()?r(E.id,{selected:!1},{silent:!0}):E.isEdge()&&a(E.id,{selected:!1},{silent:!0})}))}),null},ti=n=>{const e=O.useRef(null),{className:t,style:i,readonly:o,virtual:s,minScale:r,maxScale:a,zoomable:c,zoomOptions:d,pannable:b,panOptions:m,embedable:p,embedOptions:g,restrict:x,restrictOptions:h,connectionOptions:u,onPortRendered:y,onEdgeLabelRendered:R,createCellView:N,selectOptions:l,keyboardOptions:w,scroller:v,scrollerOptions:E,connectionEdgeOptions:T,defaultHighlightOptions:G,embedHighlightOptions:B,nodeAvailableHighlightOptions:He,magnetAvailableHighlightOptions:We,magnetAdsorbedHighlightOptions:Fe}=n,{graph:C,setGraph:ge}=O.useContext(pe);return O.useEffect(()=>{const z=new S({container:e.current,autoResize:!0,virtual:s,scaling:{min:r,max:a},connecting:{...u,createEdge(){return this.createEdge({shape:"edge",...T})}},highlighting:{default:G,embedding:B,nodeAvailable:He,magnetAvailable:We,magnetAdsorbed:Fe},onPortRendered:y,onEdgeLabelRendered:R,createCellView:N});return z.use(new F({enabled:!0,...l})),z.use(new rt({enabled:!0,...w})),v&&z.use(new at({enabled:!0,...E})),ge(z),()=>{z&&(z.dispose(),ge(null))}},[]),O.useEffect(()=>{C&&(o?C.options.interacting=!1:C.options.interacting={nodeMovable:z=>z.cell.prop("draggable")!==!1,edgeMovable:z=>z.cell.prop("draggable")!==!1,edgeLabelMovable:z=>z.cell.prop("labelDraggable")===!0})},[C,o]),O.useEffect(()=>{C&&(c?(C.enableMouseWheel(),C.options.mousewheel={...ae.defaults.mousewheel,...d,enabled:!0}):C.disableMouseWheel())},[C,c,d]),O.useEffect(()=>{C&&(b?(C.options.panning={...ae.defaults.panning,enabled:!0,...m},C.enablePanning()):C.disablePanning())},[C,b,m]),O.useEffect(()=>{C&&(p?C.options.embedding={...ae.defaults.embedding,enabled:!0,validate:()=>!0,...g}:C.options.embedding={enabled:!1,validate:()=>!1})},[C,p,g]),O.useEffect(()=>{C&&(x?C.options.translating={restrict:h?h.bound:x}:C.options.translating={restrict:!1})},[C,x,h]),_.createElement("div",{style:{width:"100%",height:"100%",...i},className:t},_.createElement("div",{ref:e,style:{width:"100%",height:"100%"}}),_.createElement(Ft,null,_.createElement(ei,{connectionEdgeOptions:T,centerView:n.centerView,centerViewOptions:n.centerViewOptions,fitView:n.fitView,fitViewOptions:n.fitViewOptions})))},Ye=class extends ue{renderMarkup(){const n=this.cell.shape==="circle"?"circle":"rect";return this.renderJSONMarkup({tagName:n,selector:"body"})}update(){super.update({body:{refWidth:"100%",refHeight:"100%",fill:Ye.nodeBackground}})}},ii=Ye;Ht(ii,"nodeBackground","#8f8f8f");const vi=()=>{var g,x,h;const[n,e]=O.useState(null),[t,i]=O.useState(null),[o]=V.useForm(),s=[{id:"start",label:"开始节点",type:"start"},{id:"end",label:"结束节点",type:"end"},{id:"approve",label:"审批节点",type:"approve"},{id:"condition",label:"条件节点",type:"condition"}],r=u=>{e(u),u.on("node:selected",({node:y})=>i(y)),u.on("edge:selected",({edge:y})=>i(y)),u.on("blank:click",()=>i(null)),u.enableSelection(),u.enablePanning(),u.zoomTo(1)},a=()=>{n&&n.toJSON()},c=()=>{n&&n.toSVG(u=>{const y=new Blob([u],{type:"image/svg+xml"}),R=URL.createObjectURL(y),N=document.createElement("a");N.href=R,N.download="flow-diagram.svg",N.click()})},d=()=>{if(n){const u=n.toJSON(),y=new Blob([JSON.stringify(u)],{type:"application/json"}),R=URL.createObjectURL(y),N=document.createElement("a");N.href=R,N.download="flow-diagram.json",N.click()}},b=u=>{t&&t.isNode()&&(t.setData(u),t.attr("label/text",u.label))},m=u=>{t&&t.isEdge()&&(t.setLabels([{attrs:{label:{text:u.label}}}]),t.setAttrs({line:{stroke:u.color,strokeWidth:u.width,targetMarker:{name:u.arrow?"block":null}}}))},p=()=>{t&&(n==null||n.removeCell(t),i(null))};return f.jsxs("div",{className:"flow-editor",children:[f.jsxs("div",{className:"toolbar",children:[f.jsx(j,{onClick:a,children:"保存"}),f.jsx(j,{onClick:()=>n==null?void 0:n.undo(),children:"撤销"}),f.jsx(j,{onClick:()=>n==null?void 0:n.redo(),children:"重做"}),f.jsx(j,{onClick:d,children:"导出 JSON"}),f.jsx(j,{onClick:c,children:"导出 SVG"})]}),f.jsxs("div",{className:"flow-editor__body",children:[f.jsx("div",{className:"node-list",children:f.jsx(Ce,{header:f.jsx("div",{children:"节点列表"}),bordered:!0,dataSource:s,renderItem:u=>f.jsx(Ce.Item,{draggable:!0,onDragStart:y=>{y.dataTransfer.setData("node/type",u.type),y.dataTransfer.setData("node/label",u.label)},children:u.label})})}),f.jsx(qt,{onLoad:r,children:f.jsx(ti,{})}),f.jsxs("div",{className:"properties-panel",children:[t&&t.isNode()&&f.jsxs(V,{form:o,layout:"vertical",onFinish:b,initialValues:t.getData(),children:[f.jsx(V.Item,{label:"标签",name:"label",children:f.jsx(ce,{})}),f.jsx(V.Item,{label:"类型",name:"type",children:f.jsxs(k,{children:[f.jsx(k.Option,{value:"start",children:"开始节点"}),f.jsx(k.Option,{value:"end",children:"结束节点"}),f.jsx(k.Option,{value:"approve",children:"审批节点"}),f.jsx(k.Option,{value:"condition",children:"条件节点"})]})}),f.jsx(j,{type:"primary",htmlType:"submit",children:"更新属性"}),f.jsx(Oe,{}),f.jsx(j,{danger:!0,onClick:p,children:"删除节点"})]}),t&&t.isEdge()&&f.jsxs(V,{form:o,layout:"vertical",onFinish:m,initialValues:{label:(h=(x=(g=t.getLabels()[0])==null?void 0:g.attrs)==null?void 0:x.label)==null?void 0:h.text,color:t.attr("line/stroke"),width:t.attr("line/strokeWidth"),arrow:t.attr("line/targetMarker/name")==="block"},children:[f.jsx(V.Item,{label:"标签",name:"label",children:f.jsx(ce,{})}),f.jsx(V.Item,{label:"颜色",name:"color",children:f.jsx(ce,{type:"color"})}),f.jsx(V.Item,{label:"宽度",name:"width",children:f.jsx(dt,{min:1,max:5})}),f.jsx(V.Item,{name:"arrow",valuePropName:"checked",children:f.jsxs(k,{children:[f.jsx(k.Option,{value:"true",children:"有箭头"}),f.jsx(k.Option,{value:"false",children:"无箭头"})]})}),f.jsx(j,{type:"primary",htmlType:"submit",children:"更新连线属性"}),f.jsx(Oe,{}),f.jsx(j,{danger:!0,onClick:p,children:"删除连线"})]})]})]})]})};export{vi as Component};
